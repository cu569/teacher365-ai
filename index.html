<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>국민건설연합 메인 상황판</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col">
  <!-- 상단 헤더 -->
  <header class="bg-indigo-600 text-white text-center py-4 shadow-md">
    <h1 class="text-2xl font-bold">국민건설연합 메인 상황판</h1>
  </header>

  <!-- 카테고리 버튼 -->
  <div class="flex flex-wrap justify-center gap-3 p-4 bg-white shadow">
    <button onclick="selectCategory('인력시장')" class="cat-btn">인력시장</button>
    <button onclick="selectCategory('단종업체')" class="cat-btn">단종업체</button>
    <button onclick="selectCategory('장비대여')" class="cat-btn">장비대여</button>
    <button onclick="selectCategory('자재구매')" class="cat-btn">자재구매</button>
    <button onclick="selectCategory('네트워크')" class="cat-btn">네트워크</button>
  </div>

  <!-- 상태 패널 -->
  <div class="bg-white mx-4 mt-4 p-3 rounded-xl shadow text-center text-indigo-700 font-semibold">
    <span id="statusText">시스템: 건설 상황판에 오신 것을 환영합니다! 카테고리를 선택하세요.</span>
  </div>

  <!-- 채팅 + 전화 -->
  <div class="flex-1 flex flex-col max-w-2xl w-full mx-auto mt-4">
    <!-- 채팅창 -->
    <div id="chatbox" class="flex-1 bg-white rounded-xl shadow p-4 mb-3 overflow-y-auto">
      <div class="text-indigo-600 mb-2">시스템: 건설 상황판 초기화 완료.</div>
    </div>
    
    <!-- 명령 입력 -->
    <form onsubmit="sendMsg(); return false;" class="flex gap-2 mb-3">
      <input id="userInput" placeholder="명령 입력 (예: 인력 등록, 장비 요청)" 
             class="flex-1 border rounded-xl p-2 focus:outline-none focus:ring-2 focus:ring-indigo-400">
      <button type="submit" class="bg-indigo-600 text-white px-4 rounded-xl font-semibold">전송</button>
    </form>

    <!-- 하단 버튼 -->
    <div class="flex gap-2 justify-between">
      <button onclick="downloadLog()" class="flex-1 bg-slate-200 py-2 rounded-xl">대화 기록 다운로드</button>
      <button onclick="callRequest()" class="flex-1 bg-emerald-500 text-white py-2 rounded-xl">전화 요청</button>
    </div>
  </div>

  <!-- 스타일 (버튼 통합 스타일) -->
  <style>
    .cat-btn {
      background:#e0e7ff; color:#4338ca; font-weight:600;
      padding:10px 20px; border-radius:12px;
      transition: all 0.2s ease;
    }
    .cat-btn:hover { background:#6366f1; color:#fff; }
  </style>

  <!-- 스크립트 -->
  <script>
    let chatlog = ["시스템: 건설 상황판 초기화 완료."];

    function updateChatbox() {
      document.getElementById('chatbox').innerHTML = chatlog.map(msg=>`<div>${msg}</div>`).join('');
      document.getElementById('chatbox').scrollTop = document.getElementById('chatbox').scrollHeight;
    }

    function selectCategory(cat) {
      chatlog.push(`시스템: "${cat}" 카테고리가 선택되었습니다.`);
      document.getElementById('statusText').textContent = `현재 카테고리: ${cat}`;
      updateChatbox();
    }

    function sendMsg() {
      const input = document.getElementById('userInput');
      const msg = input.value.trim();
      if(!msg) return;
      chatlog.push(`나: ${msg}`);
      chatlog.push(`리마: "${msg}" 요청이 접수되었습니다. 처리 중입니다...`);
      input.value = '';
      updateChatbox();
    }

    function downloadLog() {
      const blob = new Blob([chatlog.join('\n')], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'construction_chat_log.txt';
      a.click();
      URL.revokeObjectURL(url);
    }

    function callRequest() {
      alert("전화 요청이 전송되었습니다! 상대방 승인 시 연결됩니다. (WebRTC 연동 예정)");
      chatlog.push("시스템: 전화 요청이 전송되었습니다.");
      updateChatbox();
    }

    updateChatbox();
  </script>
</body>
</html>
